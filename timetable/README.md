# 时间管理可视化应用

## 项目简介

这是一个基于 Dash + Plotly 的时间管理可视化工具，用于展示和分析个人时间使用情况。

## 功能特性

### 第一阶段功能（已完成）
- ✅ 读取 `time_data/` 目录下的时间数据文件
- ✅ 显示每日时间分布的柱状图
- ✅ 点击日期查看详细事件列表
- ✅ 显示时间分布表盘（环形图）
- ✅ 支持选择显示最近3/7/14/30天的数据
- ✅ 默认显示当天数据

### 计划功能
- 🔄 右键添加时间锚点
- 🔄 双击删除时间锚点
- 🔄 撤销操作（Ctrl+Z）
- 🔄 实时数据修改和保存

## 数据格式

应用读取 `time_data/` 目录下的 JSON 文件，文件名格式为 `timedata_YYYY-MM-DD.json`。

### 数据文件示例
```json
[
  {
    "time": "00:00:00",
    "event": "未命名"
  },
  {
    "time": "14:46:00",
    "event": "编程"
  },
  {
    "time": "14:57:28",
    "event": "学习"
  }
]
```

### 数据说明
- `time`: 时间点，格式为 "HH:MM:SS"
- `event`: 事件名称
- 每个事件的实际持续时间 = 下一个时间点 - 当前时间点
- 最后一个事件的结束时间默认为 24:00:00

## 安装和运行

### 1. 安装依赖
```bash
cd timetable
pip install -r requirements.txt
```

### 2. 运行应用
```bash
python run_app.py
```

### 3. 访问应用
打开浏览器访问：http://127.0.0.1:8050

## 项目结构

```
timetable/
├── app.py              # Dash应用主文件
├── data_manager.py     # 数据管理模块
├── run_app.py          # 应用启动脚本
├── requirements.txt    # 依赖包列表
├── README.md          # 项目说明文档
└── time_data/         # 数据文件目录（上级目录）
    ├── timedata_2025-07-02.json
    └── timedata_2025-07-03.json
```

## 使用说明

### 基本操作
1. **查看数据**：应用启动后会自动加载并显示最近7天的数据
2. **切换时间范围**：使用右上角的下拉菜单选择显示天数
3. **查看详细信息**：点击柱状图中的任意日期，右侧会显示该日的详细事件列表
4. **查看时间分布**：右侧的环形图显示选中日期的时间分布情况

### 界面说明
- **左侧柱状图**：显示每日时间分布，不同颜色代表不同事件
- **右侧详细信息**：显示选中日期的所有事件及其时间区间
- **右侧表盘**：环形图显示时间分布比例
- **底部状态栏**：显示当前选中日期和数据文件数量

## 开发说明

### 核心模块
- `DataManager`: 负责数据的读取、解析和保存
- `app.py`: Dash应用的主要逻辑和界面布局
- `run_app.py`: 应用启动脚本，包含错误处理

### 数据流程
1. 应用启动时读取 `time_data/` 目录下的所有 JSON 文件
2. 解析每个文件中的时间-事件数据
3. 计算每个事件的持续时间
4. 在界面上展示柱状图、详细列表和表盘

## 故障排除

### 常见问题
1. **找不到数据文件**
   - 确保 `time_data/` 目录存在
   - 确保文件名格式正确：`timedata_YYYY-MM-DD.json`

2. **依赖包安装失败**
   - 使用 `pip install -r requirements.txt` 安装所有依赖
   - 确保 Python 版本 >= 3.7

3. **应用无法启动**
   - 检查端口 8050 是否被占用
   - 查看控制台错误信息

## 下一步开发

- 实现右键添加时间锚点功能
- 实现双击删除时间锚点功能
- 实现撤销操作机制
- 优化界面样式和交互体验 